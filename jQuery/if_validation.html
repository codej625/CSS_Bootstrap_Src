<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <title>validation</title>
</head>

<body>
    <!-- validation test html -->
    <div>
        <p>validation_test</p>
        <!-- input value의 type은 text, maxlength는 4로 기준을 정함 -->
        <input class="inputVal" type="text" value="" maxlength="4" onkeypress="if(event.keyCode == 13){btnFunc()}">
        <button class="button">생년월일 입력</button>
    </div>

</body>
<script>
    // input의 갯수가 한개인 상황이므로 focus를 사용하지 않음

    // enter input용 script
    function btnFunc() {
        // class, name은 중복이 가능해서 index를 지정
        const birthYY = document.getElementsByClassName('inputVal')[0].value;
        valueValidation(birthYY);
    };

    // .button click -> click_event run
    $('.button').click(function () {
        // .inputVal의 value를 가져와 birthYY변수에 값을 대입
        const birthYY = $('.inputVal').val();
        // validation function run
        valueValidation(birthYY);
    });

    function valueValidation(value) {
        // '' check 
        if (value.search(/\s/) > -1) {
            console.log('1-1번');
            $('.inputVal').val('');
            alert('공백은 입력할 수 없습니다.');
            return false;
        }
        // length check
        else if (value.length != 4) {
            console.log('1-2번');
            alert('4자리 숫자를 입력해주세요');
            return false;
        }
        // isNaN check
        else if (isNaN(value)) {
            console.log('1-3번');
            $('.inputVal').val('');
            alert('숫자를 입력해주세요');
            return false;
        }
        // birth validation function run
        birthValidation(value);
    }

    function birthValidation(value) {
        // value substring(0, 2)
        const birthNumFirst = value.substring(0, 2);
        // value substring(2, 4)
        const birthNumSecond = value.substring(2, 4);

        // input value의 앞 2자리 19-20 외에 모든 숫자는 return false
        if (birthNumFirst > 20 || birthNumFirst < 19) {
            console.log('first_logic');
            alert("정확한 생년월일을 입력해주세요");
            return false;
        }
        // birthNumFirst이 20일때
        else if (birthNumFirst == 20) {
            // 매년 자동으로 현재 나이를 비교하기 위해 Date객체 사용 
            // getFullYear()는 4자리 full_year return함
            const casting = new Date().getFullYear();
            // substring 내장함수를 사용하기 위해 casting
            const year = casting.toString();
            // input value의 앞 2자리가 20이고 뒷 2자리가 현재년도의 뒷 두자리보다 크면 return false
            if (birthNumSecond > year.substring(2, 4)) {
                console.log('second_logic');
                alert("정확한 생년월일을 입력해주세요");
                return false;
            }
        }
        alert('통과');
        return true;
    }

</script>

</html>